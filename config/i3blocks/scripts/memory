#!/usr/bin/env bash
# i3blocks - memory
# Affiche l'utilisation RAM en % + Go utilisés / totaux

# Lire les infos depuis /proc/meminfo (en kB)
mem_total=$(grep MemTotal /proc/meminfo | awk '{print $2}')
mem_available=$(grep MemAvailable /proc/meminfo | awk '{print $2}')

# Utilisation
mem_used=$((mem_total - mem_available))

# Conversion en Go (avec 2 décimales)
mem_used_gb=$(awk -v m="$mem_used" 'BEGIN {printf "%.2f", m/1024/1024}')
mem_total_gb=$(awk -v m="$mem_total" 'BEGIN {printf "%.2f", m/1024/1024}')

# Pourcentage avec 2 décimales
mem_pct=$(awk -v u="$mem_used" -v t="$mem_total" 'BEGIN {printf "%.2f", (u/t)*100}')

echo " MEM ${mem_pct}% (${mem_used_gb}G / ${mem_total_gb}G) "

