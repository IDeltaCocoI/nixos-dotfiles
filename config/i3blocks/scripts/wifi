#!/usr/bin/env bash
# i3blocks - Wi-Fi avec style glyphes Nerd Font série 2

# Détecter interface Wi-Fi active
ACTIVE_IF=$(nmcli -t -f DEVICE,TYPE,STATE dev status | awk -F: '$2=="wifi" && $3=="connected" {print $1; exit}')

if [ -z "$ACTIVE_IF" ]; then
    ETH_IF=$(nmcli -t -f DEVICE,TYPE,STATE dev status | awk -F: '$2=="ethernet" && $3=="connected" {print $1; exit}')
    if [ -n "$ETH_IF" ]; then
        echo " Ethernet"  # icône Ethernet Nerd Font
    else
        echo ""
    fi
    exit 0
fi

# SSID et signal
SSID=$(nmcli -t -f ACTIVE,SSID dev wifi | awk -F: '$1=="yes" {print $2; exit}')
SIGNAL=$(nmcli -t -f ACTIVE,SIGNAL dev wifi | awk -F: '$1=="yes" {print $2; exit}')

# Choisir le glyphe Nerd Font selon le signal
if [ "$SIGNAL" -ge 75 ]; then
    ICON="󰤨 "  # max
elif [ "$SIGNAL" -ge 50 ]; then
    ICON="󰤩 "  # fort
elif [ "$SIGNAL" -ge 25 ]; then
    ICON="󰤯 "  # faible
else
    ICON="󰤫 "  # très faible
fi

# Afficher SSID + icône
echo " $ICON  $SSID "

